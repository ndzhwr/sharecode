<!-- websockets.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sharecode</title>
    <link rel="stylesheet" href="/css">
</head>

<body>
    <h1>Sharecode</h1>
    <p id="output"></p>
    <div id="wrap"><textarea id="input" placeholder="Paste your code here..." spellcheck="false"
            onkeyup="send()"></textarea></div>
    <footer>Made with â™¥ by ndzhwr</footer>
    <!-- <button onclick="send()">Send</button> -->
    <script>
        id = prompt("Insert snippet id or enter a new one")
        if (!id || id.trim() == "") {
            alert("Invalid snipped ID")
        }
        var input = document.getElementById("input");
        var output = document.getElementById("output");
        var socket = window.location.hostname == 'localhost' ? new WebSocket(`ws://localhost:4000/s/${id}`) : new WebSocket(`wss://sc-9tv2.onrender.com/s/${id}`);
        output.innerHTML = "ðŸŸ¡ Connecting to " + id + "...&nbsp;";
        socket.onopen = function () {
            setTimeout(() => {
                output.innerHTML = "ðŸŸ¢ Connected to " + id;

            }, 1000);
        };
        socket.onerror = function (e) {
            console.log(e)
            output.innerHTML = "ðŸ”´Connection Error <span id='rld' onclick='rld()'>Try reload</span>";
        };
        socket.onmessage = function (e) {
            input.value = e.data;
        };
        function send() {
            socket.send(input.value);
        }
        function rld() {
            window.location.reload();
        }
    </script>
</body>

</html>